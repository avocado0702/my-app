{"version":3,"sources":["main/core/components/plan_info.cljs"],"mappings":";AAIA,0CAAA,1CAAMA;AAAN,AAAA,0FAAA,yDAAA,2CAAA,6DAAA;AAAA,AAEuB,8BAAA,mFAAA,wEAAA,lLAACC;WAFxB;;AAIA,0CAAA,1CAAMC,4FACHC,iBAAiBC,aAAaC;AADjC,AAAA,0FAAA,yDAAA,2CAAA,6DAAA;AAAA,AAGe,AAAI,uBAAA,mFAAA,kEAAA,AAAAC,kCAAA,AAAAA,8BAAA,AAAAA,5OAACL,4LAAiCE,kCAAkBC,8BAC/BC;;AACrB,8BAAA,mFAAA,wEAAA,lLAACJ;WALpB;;AASA,2CAAA,3CAAMM;AAAN,AAEE,IAAMC,YAAU,sDAAA,mFAAA,zIAACC;IACXN,mBAAiB,sDAAA,mFAAA,zIAACM;IAClBL,eAAa,gDAAA,hDAACM;IACdL,cAAY,gDAAA,hDAACK;IACbC,eAAa,gDAAA,hDAACD;AAJpB,AAKE;AAAA,AACE,mBAAA,AAAAJ,fAAMM,+BAAc,sDAAA,mFAAA,wEAAA,AAAAN,jNAACG,iOACqBN;AAD1C,AAGE,oBAAM,iBAAAU,oBAAKD;AAAL,AAAA,oBAAAC;AAAkB,uDAAA,AAAAP,8BAAA,AAAAA,9EAACQ,gEAAMH,8BAAcR;;AAAvCU;;;AAAN,AACE,mCAAA,AAAAP,nCAACS,sBAAOJ,6BAAcR;;AACtB,AAACY,sBAAOX,aAAa,AAAA,qFAAQQ;;AAC7B,AAACG,sBAAOV,YAAY,AAAA,kGAAcO;;AAHpC;;AAIA,oBAAA,AAAAN,gBAAKH;AACH,oBAAA,AAAAG,gBAAKE;AAAL,0FAAA,kFAAA,mFAAA,iDAAA,oBAAA,mFAAA,uDAAA,mFAAA,sDAAA,mFAAA,kDAAA,mFAAA,iDAAA,kBAAA,mFAAA,iDAAA,mFAAA,sDAAA,2CAAA,qDAAA,OAAA,sDAAA,AAAAF,8BAAA,+DAAA,WAAAU,xFAQiBZ;AARjB,AASqB,OAACW,sBAAOX,aAAa,AAAA,AAAAY;mCAT1C,mFAAA,kDAAA,mFAAA,iDAAA,oBAAA,mFAAA,iDAAA,mFAAA,6DAAA,2CAAA,sDAAA,AAAAV,6BAAA,+DAAA,WAAAW,vFAeiBZ;AAfjB,AAgBqB,OAACU,sBAAOV,YAAY,AAAA,AAAAY;mDAhBzC,mFAmBIf,wCAASC,iBAAiBC,aAAaC;;AAnB3C,0FAAA,wEAAA,mFAAA,mOAAA,mFAAA,+OAAA,pfAoBuB,CAAA,2DAAoB,AAAA,qFAAQO,kKAC5C,CAAA,6DAAsB,AAAA,kGAAcA,oHACvCZ,wCAASQ;;;AAvBf,0FAAA,8CAAA","names":["main.core.components.plan-info/edit-btn","re-frame.core/dispatch","main.core.components.plan-info/save-btn","selected-item-id","edited-title","edited-text","cljs.core/deref","main.core.components.plan-info/plan-info","edit-mode","re_frame.core.subscribe","reagent.core.atom","last-item-id","current-plan","and__5000__auto__","cljs.core.not_EQ_","cljs.core/reset!","p1__27065#","p1__27066#"],"sourcesContent":["(ns main.core.components.plan-info\r\n  (:require [re-frame.core :as re-frame]\r\n            [reagent.core :as r]))\r\n\r\n(defn edit-btn\r\n  []\r\n  [:button {:on-click #(re-frame/dispatch [:set-edit-mode true])} \"Edit\"])\r\n\r\n(defn save-btn\r\n  [selected-item-id edited-title edited-text]\r\n  [:button\r\n   {:on-click #(do (re-frame/dispatch [:update-plan @selected-item-id @edited-title\r\n                                       @edited-text])\r\n                   (re-frame/dispatch [:set-edit-mode false])\r\n                   )}\r\n   \"Save\"])\r\n\r\n(defn plan-info\r\n  []\r\n  (let [edit-mode (re-frame/subscribe [:get-edit-mode])\r\n        selected-item-id (re-frame/subscribe [:get-selected-plan-id])\r\n        edited-title (r/atom nil)\r\n        edited-text (r/atom nil)\r\n        last-item-id (r/atom nil)] ;; \u7528\u4e8e\u8ddf\u8e2a\u4e0a\u4e00\u4e2a selected-item-id\r\n    (fn []\r\n      (let [current-plan @(re-frame/subscribe [:get-plan-by-id\r\n                                               @selected-item-id])]\r\n        ;; \u5f53 selected-item-id \u53d8\u5316\u65f6\uff0c\u66f4\u65b0\u7f16\u8f91\u5185\u5bb9\r\n        (when (and current-plan (not= @last-item-id @selected-item-id))\r\n          (reset! last-item-id @selected-item-id) ;; \u66f4\u65b0 last-item-id\r\n          (reset! edited-title (:titel current-plan))\r\n          (reset! edited-text (:description current-plan)))\r\n        (if @selected-item-id\r\n          (if @edit-mode\r\n            [:div.plan-info-edit [:h2 \"Edit Plan\"]\r\n             [:table\r\n              [:tbody\r\n               [:tr [:td \"Title: \"]\r\n                [:td\r\n                 [:input\r\n                  {:type \"text\",\r\n                   :value @edited-title,\r\n                   :on-change #(reset! edited-title (-> %\r\n                                                        .-target\r\n                                                        .-value))}]]]\r\n               [:tr [:td \"Content: \"]\r\n                [:td\r\n                 [:textarea\r\n                  {:value @edited-text,\r\n                   :on-change #(reset! edited-text (-> %\r\n                                                       .-target\r\n                                                       .-value))}]]]]]\r\n             [save-btn selected-item-id edited-title edited-text]]\r\n            [:div.plan-info [:h2 (str \"Plan Title: \" (:titel current-plan))]\r\n             [:p (str \"Plan Content: \" (:description current-plan))]\r\n             [edit-btn edit-mode]])\r\n          [:p \"Select a plan to see details\"])))))\r\n"]}