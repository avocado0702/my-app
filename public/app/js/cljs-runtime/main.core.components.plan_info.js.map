{"version":3,"sources":["main/core/components/plan_info.cljs"],"mappings":";AAIA,0CAAA,1CAAMA,4FACHC;AADH,AAAA,0FAAA,yDAAA,2CAAA,6DAAA;AAAA,AAGe,AAAI,gCAAA,hCAACC,sBAAOD;;AACR,mBAAA,YAAA,AAAAE,xBAACC,wCAA4BH;WAJhD;;AAMA,0CAAA,1CAAMI,4FACHJ,UAAUK,iBAAiBC,aAAaC;AAD3C,AAAA,0FAAA,yDAAA,2CAAA,6DAAA;AAAA,AAGe,AAAI,gCAAA,hCAACN,sBAAOD;;AACR,8BAAA,mFAAA,kEAAA,AAAAE,kCAAA,AAAAA,8BAAA,AAAAA,5OAACM,4LAAiCH,kCAAkBC,8BAC/BC;WALxC;;AAQA,2CAAA,3CAAME,8FACHT;AADH,AAEE,IAAMK,mBAAiB,sDAAA,mFAAA,zIAACK;IAClBJ,eAAa,gDAAA,hDAACK;IACdJ,cAAY,gDAAA,hDAACI;IACbC,eAAa,gDAAA,hDAACD;AAHpB,AAIE;AAAA,AACE,mBAAA,AAAAT,fAAMW,+BAAc,sDAAA,mFAAA,wEAAA,AAAAX,jNAACQ,iOACqBL;AAD1C,AAGE,oBAAM,iBAAAS,oBAAKD;AAAL,AAAA,oBAAAC;AAAkB,uDAAA,AAAAZ,8BAAA,AAAAA,9EAACa,gEAAMH,8BAAcP;;AAAvCS;;;AAAN,AACE,mCAAA,AAAAZ,nCAACD,sBAAOW,6BAAcP;;AACtB,AAACJ,sBAAOK,aAAa,AAAA,qFAAQO;;AAC7B,AAACZ,sBAAOM,YAAY,AAAA,oFAAOM;;AAH7B;;AAIA,oBAAA,AAAAX,gBAAKG;AACH,oBAAA,AAAAH,gBAAKF;AAAL,0FAAA,kFAAA,mFAAA,iDAAA,oBAAA,mFAAA,uDAAA,mFAAA,sDAAA,mFAAA,kDAAA,mFAAA,iDAAA,kBAAA,mFAAA,iDAAA,mFAAA,sDAAA,2CAAA,qDAAA,OAAA,sDAAA,AAAAE,8BAAA,+DAAA,WAAAc,xFAQiBV;AARjB,AASqB,OAACL,sBAAOK,aAAa,AAAA,AAAAU;mCAT1C,mFAAA,kDAAA,mFAAA,iDAAA,oBAAA,mFAAA,iDAAA,mFAAA,6DAAA,2CAAA,sDAAA,AAAAd,6BAAA,+DAAA,WAAAe,vFAeiBV;AAfjB,AAgBqB,OAACN,sBAAOM,YAAY,AAAA,AAAAU;mDAhBzC,mFAmBIb,wCAASJ,UAAUK,iBAAiBC,aAAaC;;AAnBrD,0FAAA,wEAAA,mFAAA,mOAAA,mFAAA,iOAAA,teAoBuB,CAAA,2DAAoB,AAAA,qFAAQM,kKAC5C,CAAA,6DAAsB,AAAA,oFAAOA,oHAChCd,wCAASC;;;AAvBf,0FAAA,8CAAA","names":["main.core.components.plan-info/edit-btn","edit-mode","cljs.core/reset!","cljs.core/deref","js/console.log","main.core.components.plan-info/save-btn","selected-item-id","edited-title","edited-text","re-frame.core/dispatch","main.core.components.plan-info/plan-info","re_frame.core.subscribe","reagent.core.atom","last-item-id","current-plan","and__5000__auto__","cljs.core.not_EQ_","p1__26387#","p1__26388#"],"sourcesContent":["(ns main.core.components.plan-info\r\n  (:require [re-frame.core :as re-frame]\r\n            [reagent.core :as r]))\r\n\r\n(defn edit-btn\r\n  [edit-mode]\r\n  [:button\r\n   {:on-click #(do (reset! edit-mode true)\r\n                   (js/console.log \"EDIT MODE\" @edit-mode))} \"Edit\"])\r\n\r\n(defn save-btn\r\n  [edit-mode selected-item-id edited-title edited-text]\r\n  [:button\r\n   {:on-click #(do (reset! edit-mode false)\r\n                   (re-frame/dispatch [:update-plan @selected-item-id @edited-title\r\n                                       @edited-text]))}\r\n   \"Save\"])\r\n\r\n(defn plan-info\r\n  [edit-mode]\r\n  (let [selected-item-id (re-frame/subscribe [:get-selected-plan-id])\r\n        edited-title (r/atom nil)\r\n        edited-text (r/atom nil)\r\n        last-item-id (r/atom nil)] ;; \u7528\u4e8e\u8ddf\u8e2a\u4e0a\u4e00\u4e2a selected-item-id\r\n    (fn []\r\n      (let [current-plan @(re-frame/subscribe [:get-plan-by-id\r\n                                               @selected-item-id])]\r\n        ;; \u5f53 selected-item-id \u53d8\u5316\u65f6\uff0c\u66f4\u65b0\u7f16\u8f91\u5185\u5bb9\r\n        (when (and current-plan (not= @last-item-id @selected-item-id))\r\n          (reset! last-item-id @selected-item-id) ;; \u66f4\u65b0 last-item-id\r\n          (reset! edited-title (:titel current-plan))\r\n          (reset! edited-text (:text current-plan)))\r\n        (if @selected-item-id\r\n          (if @edit-mode\r\n            [:div.plan-info-edit [:h2 \"Edit Plan\"]\r\n             [:table\r\n              [:tbody\r\n               [:tr [:td \"Title: \"]\r\n                [:td\r\n                 [:input\r\n                  {:type \"text\",\r\n                   :value @edited-title,\r\n                   :on-change #(reset! edited-title (-> %\r\n                                                        .-target\r\n                                                        .-value))}]]]\r\n               [:tr [:td \"Content: \"]\r\n                [:td\r\n                 [:textarea\r\n                  {:value @edited-text,\r\n                   :on-change #(reset! edited-text (-> %\r\n                                                       .-target\r\n                                                       .-value))}]]]]]\r\n             [save-btn edit-mode selected-item-id edited-title edited-text]]\r\n            [:div.plan-info [:h2 (str \"Plan Title: \" (:titel current-plan))]\r\n             [:p (str \"Plan Content: \" (:text current-plan))]\r\n             [edit-btn edit-mode]])\r\n          [:p \"Select a plan to see details\"])))))\r\n"]}